<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FishingRPG - Your Fishing Adventure</title>
    <!-- ... Stylesheet unchanged for brevity ... -->
    <style>
        /* ... Styles remain unchanged ... */
        /* (for brevity, see your code above) */
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <div style="display:flex;justify-content:space-between;align-items:center;">
            <div>
                <h1>üé£ FishingRPG</h1>
                <p>Cast your line and catch the big one!</p>
            </div>
            <div style="text-align:right;">
                <div style="font-size:0.9em;margin-bottom:4px;">
                    Logged in as: <span id="accountName">‚Ä¶</span>
                </div>
                <button
                    onclick="loginWithDiscord()"
                    style="padding:6px 12px;border-radius:999px;border:none;
                           background:#5865F2;color:white;font-weight:600;
                           cursor:pointer;font-size:0.9em;">
                    Login with Discord
                </button>
            </div>
        </div>
    </div>

    <div class="game-layout">
        <!-- Left Sidebar -->
        <div class="sidebar">
            <div class="panel">
                <h3>Player Stats</h3>
                <div class="stat-item">
                    <span class="stat-label">Level</span>
                    <span class="stat-value" id="playerLevel">1</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Experience</span>
                    <span class="stat-value" id="playerXP">0 / 100</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="xpBar" style="width: 0%">0%</div>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Energy</span>
                    <span class="stat-value" id="playerEnergy">100 / 100</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="energyBar" style="width: 100%">100%</div>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Gold</span>
                    <span class="stat-value" id="playerGold">50</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Total Fish</span>
                    <span class="stat-value" id="totalFish">0</span>
                </div>
                <hr style="margin:10px 0; border:none; border-top:1px solid #ddd;">
                <div class="stat-item">
                    <span class="stat-label">Location</span>
                    <span class="stat-value" id="currentLocationLabel">Sunny Lake</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Time</span>
                    <span class="stat-value" id="timeOfDayLabel">Day</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Weather</span>
                    <span class="stat-value" id="weatherLabel">Clear</span>
                </div>
            </div>

            <div class="panel">
                <h3>Equipment</h3>
                <div id="equipmentList"></div>
            </div>
        </div>

        <!-- Middle: Tabs + content -->
        <div class="main-area">
            <div class="panel">
                <div class="tabs">
                    <button class="tab-button active" onclick="switchTab('fishing', this)">üé£ Fishing</button>
                    <button class="tab-button" onclick="switchTab('shop', this)">üõí Shop</button>
                    <button class="tab-button" onclick="switchTab('sell', this)">üí∞ Sell Fish</button>
                    <button class="tab-button" onclick="switchTab('locations', this)">üó∫Ô∏è Locations</button>
                    <button class="tab-button" onclick="switchTab('encyclopedia', this)">üìñ Encyclopedia</button>
                    <button class="tab-button" onclick="switchTab('leaderboard', this)">üèÜ Leaderboard</button>
                    <button class="tab-button" onclick="switchTab('chat', this)">üí¨ Chat</button>
                </div>

                <!-- Fishing Tab -->
                <div id="fishingTab" class="tab-content active">
                    <h3>Fishing Zone</h3>
                    <div class="fishing-zone" id="fishingZone">
                        <div class="water-animation"></div>
                        <div class="fish-icon" id="fishIcon">üêü</div>
                        <p style="color:white;font-size:1.1em;margin:10px 0;" id="fishingStatus">Ready to fish!</p>
                        <button class="fish-button" id="fishButton" onclick="goFishing()">üé£ Cast Line (10 Energy)</button>

                        <div class="timing-game" id="timingGame">
                            <div class="bite-indicator" id="biteIndicator" style="display:none;">üé£ BITE!</div>
                            <div class="timing-instructions" id="timingInstructions">Waiting for a bite...</div>
                            <div class="timing-bar-container">
                                <div class="timing-zone" id="timingZone" style="display:none;"></div>
                                <div class="timing-bar" id="timingBar" style="display:none;"></div>
                            </div>
                            <button class="fish-button" id="reelButton" onclick="reelIn()" style="display:none;margin-top:15px;">
                                üé£ REEL IN!
                            </button>
                        </div>

                        <div id="catchMessage"></div>
                    </div>
                </div>

                <!-- Shop Tab -->
                <div id="shopTab" class="tab-content">
                    <h3>Equipment Shop</h3>
                    <div id="shopContent"></div>
                </div>

                <!-- Sell Tab -->
                <div id="sellTab" class="tab-content">
                    <h3>Sell Your Fish</h3>
                    <div id="sellContent"></div>
                </div>

                <!-- Locations Tab -->
                <div id="locationsTab" class="tab-content">
                    <h3>Fishing Locations</h3>
                    <p style="font-size:0.9em; color:#666; margin-bottom:10px;">
                        Different locations change energy cost and the chance of rare fish. Some require higher levels to unlock.
                    </p>
                    <div id="locationsContent"></div>
                </div>

                <!-- Encyclopedia Tab -->
                <div id="encyclopediaTab" class="tab-content">
                    <h3>Fish Encyclopedia</h3>
                    <p style="font-size:0.9em; color:#666; margin-bottom:10px;">
                        Catch fish to discover their entries. Track largest catches and rarity!
                    </p>
                    <div id="encyclopediaContent"></div>
                </div>

                <!-- Leaderboard Tab -->
                <div id="leaderboardTab" class="tab-content">
                    <h3>Global Leaderboard</h3>
                    <p style="font-size:0.9em; color:#666; margin-bottom:10px;">
                        Top 100 players worldwide. Compete by level, total fish caught, and biggest catch!
                    </p>
                    <div id="leaderboardContent">
                        <p style="color:#999; text-align:center; padding:15px;">Connecting to leaderboard...</p>
                    </div>
                </div>

                <!-- Chat Tab -->
                <div id="chatTab" class="tab-content">
                    <h3>Global Chat</h3>
                    <div id="chatMessages"
                         style="height:260px; overflow-y:auto; background:#ffffff; border:1px solid #ccc; border-radius:8px; padding:10px; margin-bottom:10px;">
                        <p style="color:#999; text-align:center;">No messages yet...</p>
                    </div>
                    <div style="display:flex; gap:8px;">
                        <input id="chatInput" type="text" placeholder="Type a message..."
                               style="flex:1; padding:10px; border-radius:6px; border:1px solid #ccc;">
                        <button onclick="sendChatMessage()"
                                style="padding:10px 20px; background:#2193b0; color:white; border:none; border-radius:6px; cursor:pointer;">
                            Send
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Sidebar - Inventory -->
        <div class="sidebar">
            <div class="panel">
                <h3>Inventory</h3>
                <div class="inventory" id="inventoryList">
                    <p style="color:#999; text-align:center; padding:20px;">No fish caught yet!</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- MAIN GAME SCRIPT -->
<script>
    // FIXED: Ensure only one renderInventory, only defined once and correctly.
    function renderInventory() {
        const inventoryList = document.getElementById('inventoryList');
        const fishNames = Object.keys(gameState.inventory).sort();
        if (fishNames.length === 0) {
            inventoryList.innerHTML = '<p style="color:#999;text-align:center;padding:20px;">No fish caught yet!</p>';
            return;
        }
        inventoryList.innerHTML = fishNames.map(fishName => {
            const fish = (typeof fishDatabase !== "undefined") ? fishDatabase.find(f => f.name === fishName) : null;
            const count = gameState.inventory[fishName];
            const iconHtml = (fish && fish.icon && fish.icon.endsWith('.png'))
                ? `<img src="${fish.icon}" class="small-fish-icon" alt="${fishName}">`
                : '<span style="font-size:1.2em;margin-right:6px;vertical-align:middle;">üêü</span>';
            return `
                <div class="inventory-item">
                    <span class="inventory-item-name">${iconHtml}${fishName}</span>
                    <span class="inventory-item-count">${count}</span>
                </div>
            `;
        }).join('');
    }
    // ...rest of your game logic and code (unchanged, as per original file)...
</script>
<!-- FIREBASE + LEADERBOARD + CHAT SCRIPT stays unchanged - rest of your code here... -->
<script type="module">
    // ...existing code remains unchanged...
</script>
</body>
</html>
